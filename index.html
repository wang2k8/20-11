<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Parallax - Chỉ Xoay Ảnh</title>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        html, body {
            height: 100%;
            background: #fff; /* nền trắng */
            overflow: hidden;
            touch-action: none;
        }
        .container {
            position: fixed;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        img {
            position: absolute;
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            pointer-events: none;
            user-select: none;
            transition: transform 0.08s ease-out;
        }
        /* Chỉ xoay ảnh khi điện thoại DỌC */
        @media (orientation: portrait) and (max-width: 768px) {
            .container {
                transform: rotate(90deg);
            }
            /* Đổi chiều để ảnh vẫn full sau khi xoay */
            html, body { width: 100vh; height: 100vw; }
            .container { width: 100vh; height: 100vw; }
        }
        /* iOS fix */
        @supports (height: 100dvh) {
            @media (orientation: portrait) and (max-width: 768px) {
                html, body { width: 100dvh; height: 100dvw; }
                .container { width: 100dvh; height: 100dvw; }
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <img id="l5" src="img1.png"> <!-- xa nhất -->
        <img id="l4" src="img2.png">
        <img id="l3" src="img3.png">
        <img id="l2" src="img4.png">
        <img id="l1" src="img5.png"> <!-- gần nhất -->
    </div>

    <script>
        const layers = [
            {el: document.getElementById('l1'), s: 0.12},
            {el: document.getElementById('l2'), s: 0.30},
            {el: document.getElementById('l3'), s: 0.55},
            {el: document.getElementById('l4'), s: 0.80},
            {el: document.getElementById('l5'), s: 1.00}
        ];
        const max = 90;
        const mobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

        function move(x, y) {
            layers.forEach(l => {
                const mx = Math.tanh(x * l.s / max) * max;
                const my = Math.tanh(y * l.s / max) * max;
                l.el.style.transform = 
                    `translate(${mx}px, ${my}px) rotateY(${x*0.15}deg) rotateX(${-y*0.1}deg)`;
            });
        }

        if (mobile) {
            window.addEventListener('deviceorientation', e => {
                if (e.gamma === null) return;
                let x = e.gamma;   // -90 ~ 90
                let y = e.beta;
                if (y > 90) y = 90;
                if (y < -90) y = -90;
                move(x * 2.4, y * 2.4);
            });
        } else {
            document.addEventListener('mousemove', e => {
                const x = (e.clientX / innerWidth - 0.5) * 2;
                const y = (e.clientY / innerHeight - 0.5) * 2;
                move(x * 60, y * 60);
            });
        }

        // Reset khi xoay màn hình
        window.addEventListener('orientationchange', () => setTimeout(() => move(0,0), 400));
        window.addEventListener('resize', () => setTimeout(() => move(0,0), 200));
        
        move(0, 0);
    </script>
</body>
</html>
